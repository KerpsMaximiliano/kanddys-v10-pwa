<app-navigation [opened]="openNavigation" (closed)="openNavigation = false">
  <div class="container">
    <!-- <header class="header">
      <div class="left">
        <button class="btn merchant-btn" [matMenuTriggerFor]="menu">
          <img [src]="_MerchantsService.merchantData.image" class="img" />
          <p class="title">{{ _MerchantsService.merchantData.name }}</p>
        </button>
      </mat-menu>
    </div>

    <div class="right">
      <a
        class="btn"
        [routerLink]="['../notifications-menu']"
        [queryParams]="{
          redirectTo: router.url
        }"
        *ngIf="ordersToConfirm.length === 0"
      >
        <img class="listIcon" [src]="environment + '/icon-i.svg'" />
      </a>

      <a
        class="btn"
        [routerLink]="['../notifications-menu']"
        [queryParams]="{
          redirectTo: router.url
        }"
        *ngIf="ordersToConfirm.length > 0"
      >
        <img class="listIcon" [src]="environment + '/bell-notification.svg'" />
      </a>
    </div>
  </header> -->

    <header class="header">
      <!--
      
    -->
      <button mat-icon-button style="margin-right: 25px">
        <mat-icon [ngStyle]="{ color: 'white' }">search</mat-icon>
      </button>
      <button mat-icon-button style="margin-right: 25px" (click)="newArticle()">
        <mat-icon [ngStyle]="{ color: 'white' }">add</mat-icon>
      </button>
      <button class="header-btn" (click)="headerSettings()">
        <img [src]="environment + '/dots-black.svg'" alt="" />
      </button>

      <button
        style="
          color: #87cd9b;
          font-size: 17px;
          font-family: InterBold;
          margin-left: auto;
        "
      >
        Lo que vendo üè∑Ô∏è
        <mat-icon style="color: #6fcf97; margin-left: 8px">menu</mat-icon>
      </button>
    </header>

    <div class="categories">
      <swiper [config]="swiperConfig" class="category-swiper">
        <div
          class="category-item"
          [ngClass]="{
            active: !selectedFilter && !selectedTags.length
          }"
        >
          TODOS
        </div>
        <div
          class="category-item queryParam"
          *ngFor="let filter of filters; let i = index"
          [ngClass]="{
            active: selectedFilter && selectedFilter._id === filter._id
          }"
          (click)="isFilterActive(filter)"
        >
          <i
            class="fas fa-times-circle close-icon"
            style="align-self: center; padding-right: 6.5px"
          ></i>
          {{
            filter.type === "queryParameter"
              ? formatDate(filter.queryParameter.from.date, true) +
                " - " +
                formatDate(filter.queryParameter.until.date, true)
              : "Otro"
          }}
          <mat-menu #menu="matMenu">
            <a mat-menu-item [routerLink]="['']">
              <mat-icon>settings</mat-icon>
              <span>Configuraci√≥n</span>
            </a>
            <button mat-menu-item (click)="logout()">
              <mat-icon>exit_to_app</mat-icon>
              <span>Cerrar Sesi√≥n</span>
            </button>
          </mat-menu>
        </div>
      </swiper>
    </div>

    <!-- <div class="contents">
    <app-options-bar
      [type]="'3'"
      [options]="options"
      (selectedIndex)="selectTag($event)"
      (selectedMenuIndex)="selectedMenuOption($event)"
    >
    </app-options-bar>
  </div> -->

    <mat-form-field appearance="fill" style="display: none">
      <mat-label>Enter a date range</mat-label>
      <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
        <input matStartDate formControlName="start" placeholder="Start date" />
        <input
          matEndDate
          formControlName="end"
          (dateChange)="onDateChange()"
          placeholder="End date"
        />
      </mat-date-range-input>
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-date-range-picker #picker></mat-date-range-picker>
    </mat-form-field>

    <div class="section" *ngIf="mostSoldItems.length">
      <div class="section-header">
        <p class="section-title">Vendidos</p>

        <div class="section-description" (click)="goToDetail('sold')">
          <!-- <p>4 de los √∫ltimos 7 d√≠as</p> -->
          <p>{{ mostSoldItems.length }}</p>
          <img [src]="environment + '/arrow-left.svg'" alt="" />
        </div>
      </div>

      <qrcode
        *ngIf="articleId"
        style="display: none"
        #orderQrCode
        [qrdata]="
          URI +
          '/ecommerce/' +
          _SaleflowService.saleflowData.merchant.slug +
          '/article-detail/item/' +
          articleId
        "
        [elementType]="'img'"
        [width]="40"
        [errorCorrectionLevel]="'M'"
        [allowEmptyString]="true"
        colorDark="#000"
      ></qrcode>

      <div class="section-content">
        <swiper [config]="cardSwiperConfig">
          <div
            class="item-wrapper"
            *ngFor="let item of mostSoldItems; index as i"
          >
            <app-item-admin-card
              [item]="item"
              [unitSalesCounter]="
                itemsSelledCountByItemId[item._id]
                  ? itemsSelledCountByItemId[item._id]
                  : 0
              "
            ></app-item-admin-card>
          </div>
        </swiper>
      </div>
    </div>

    <div class="section" *ngIf="itemsBoughtByMe?.length">
      <div class="section-header">
        <p class="section-title">He comprado</p>

        <div class="section-description" (click)="goToDetail('sold')">
          <!-- <p>4 de los √∫ltimos 7 d√≠as</p> -->
          <p>{{ itemsBoughtByMe.length }}</p>
          <img [src]="environment + '/arrow-left.svg'" alt="" />
        </div>
      </div>

      <qrcode
        *ngIf="articleId"
        style="display: none"
        #orderQrCode
        [qrdata]="
          URI +
          '/ecommerce/' +
          _SaleflowService.saleflowData.merchant.slug +
          '/article-detail/item/' +
          articleId
        "
        [elementType]="'img'"
        [width]="40"
        [errorCorrectionLevel]="'M'"
        [allowEmptyString]="true"
        colorDark="#000"
      ></qrcode>

      <div class="section-content">
        <swiper [config]="cardSwiperConfig">
          <div
            class="item-wrapper"
            *ngFor="let item of itemsBoughtByMe; index as i"
          >
            <app-item-admin-card
              [item]="item"
              [unitSalesCounter]="
                itemsSelledCountByItemId[item._id]
                  ? itemsSelledCountByItemId[item._id]
                  : 0
              "
            ></app-item-admin-card>
          </div>
        </swiper>
      </div>
    </div>

    <div class="section" *ngIf="hiddenItems?.length">
      <div class="section-header">
        <p class="section-title">Ocultos</p>

        <div class="section-description" (click)="goToDetail('hidden')">
          <p>{{ hiddenItems.length }}</p>
          <img [src]="environment + '/arrow-left.svg'" alt="" />
        </div>
      </div>

      <div class="section-content">
        <swiper [config]="cardSwiperConfig">
          <div
            class="item-wrapper"
            *ngFor="let item of hiddenItems; index as i"
          >
            <app-item-admin-card
              [item]="item"
              [unitSalesCounter]="
                itemsSelledCountByItemId[item._id]
                  ? itemsSelledCountByItemId[item._id]
                  : 0
              "
            ></app-item-admin-card>
          </div>
        </swiper>
      </div>
    </div>

    <div class="section" *ngIf="notSoldItems?.length">
      <div class="section-header">
        <p class="section-title">Sin Venderse</p>

        <div class="section-description" (click)="goToDetail('notSold')">
          <p>{{ notSoldItems.length }}</p>
          <img [src]="environment + '/arrow-left.svg'" alt="" />
        </div>
      </div>

      <div class="section-content">
        <swiper [config]="cardSwiperConfig">
          <div
            class="item-wrapper"
            *ngFor="let item of notSoldItems; index as i"
          >
            <app-item-admin-card
              [item]="item"
              [unitSalesCounter]="
                itemsSelledCountByItemId[item._id]
                  ? itemsSelledCountByItemId[item._id]
                  : 0
              "
            ></app-item-admin-card>
          </div>
        </swiper>
      </div>
    </div>

    <div class="section" *ngIf="allItems?.length" style="margin-bottom: 105px">
      <div class="section-header">
        <p class="section-title">Todos</p>

        <div class="section-description" (click)="goToDetail('allItems')">
          <p>{{ allItems.length }}</p>
          <img [src]="environment + '/arrow-left.svg'" alt="" />
        </div>
      </div>

      <div class="section-content">
        <swiper [config]="cardSwiperConfig">
          <div class="item-wrapper" *ngFor="let item of allItems; index as i">
            <app-item-admin-card
              [item]="item"
              [unitSalesCounter]="
                itemsSelledCountByItemId[item._id]
                  ? itemsSelledCountByItemId[item._id]
                  : 0
              "
            ></app-item-admin-card>
          </div>
        </swiper>
      </div>
    </div>

    <!-- <div class="uploadButton">
    <button mat-fab class="button" (click)="settings()">
      <mat-icon style="color: #82f18d">menu</mat-icon>
      
    </button>
  </div> -->

    <div class="sticky-bar" (click)="openDatePicker()">
      <p>{{ dateString }}</p>
      <img [src]="environment + '/dots-black.svg'" alt="" />
      <!-- <div>
      <p>VISIBLE EN: URL.COM</p>
      <img [src]="environment + '/upload.svg'" alt="">
    </div> -->
    </div>

    <!-- <div
    class="saleflows-item-grid"
    (scroll)="infinitePagination()"
    *ngIf="allItems.length && (layout === 'simple-card' || !layout)"
  >
    <a
      class="capsize"
      [routerLink]="['../article-editor', item._id]"
      *ngFor="let item of allItems; let itemIndex = index"
    >
      <app-saleflow-item
        [itemIndex]="itemIndex"
        [itemId]="item._id"
        [type]="4"
        [showViews]="true"
        [viewsCounter]="item.visitorCounter ? item.visitorCounter.counter : 0"
        [inactive]="
          item.status != 'active' && item.status != 'featured' ? true : false
    <header class="header">
      <button mat-icon-button>
        <mat-icon [ngStyle]="{ color: 'white' }">search</mat-icon>
      </button>
      <button mat-icon-button (click)="newArticle()">
        <mat-icon [ngStyle]="{ color: 'white' }">add</mat-icon>
      </button>
      <button class="header-btn" (click)="headerSettings()">
        <img [src]="environment + '/dots-black.svg'" alt="" />
      </button>

      <button
        style="
          color: #82f18d;
          font-size: 16px;
          font-family: SFProRegular;
          margin-left: auto;
        "
        (click)="openNavigation = true"
      >
        Art√≠culos
        <mat-icon  style="color: #82f18d; margin-left: 8px">menu</mat-icon>
      </button>
    </header>

    <div class="categories">
      <swiper [config]="swiperConfig">
        <div class="category-item active">TODOS</div>
        <div
          class="category-item"
          *ngFor="let filter of filters; let i = index"
          [ngClass]="{ active: selectedFilter && selectedFilter._id === filter._id }"
          (click)="isFilterActive(filter)"
        >
          {{
            filter.type === "queryParameter"
              ? formatDate(filter.queryParameter.from.date, true) +
                " - " +
                formatDate(filter.queryParameter.until.date, true)
              : "Otro"
          }}
        </div>
        <div
          class="category-item"
          *ngFor="let tag of tags; let i = index"
          [ngClass]="{ active: isTagActive(tag) }"
          (click)="filterTag(i)"
        >
          {{ tag.name }}
        </div>
      </swiper>
    </div>

    <div class="contents">
      <app-options-bar
        [type]="'3'"
        [options]="options"
        (selectedIndex)="selectTag($event)"
        (selectedMenuIndex)="selectedMenuOption($event)"
      >
      </app-options-bar>
    </div> -->

    <div class="uploadButton">
      <button mat-fab class="button" (click)="settings()">
        <mat-icon style="color: #82f18d">menu</mat-icon>
        <!-- <img class="icon" [src]="environment + '/upload.svg'" /> -->
      </button>
    </div>

    <div class="sticky-bar" (click)="openDatePicker()">
      <p>{{ dateString }}</p>
      <img [src]="environment + '/dots-black.svg'" alt="" />
      <!-- <div>
        <p>VISIBLE EN: URL.COM</p>
        <img [src]="environment + '/upload.svg'" alt="">
      </div> -->
    </div>

    <!-- <div
      class="saleflows-item-grid"
      (scroll)="infinitePagination()"
      *ngIf="allItems.length && (layout === 'simple-card' || !layout)"
    >
      <a
        class="capsize"
        [routerLink]="['../article-editor', item._id]"
        *ngFor="let item of allItems; let itemIndex = index"
      >
        <app-saleflow-item
          [itemIndex]="itemIndex"
          [itemId]="item._id"
          [type]="4"
          [showViews]="true"
          [viewsCounter]="item.visitorCounter ? item.visitorCounter.counter : 0"
          [inactive]="
            item.status != 'active' && item.status != 'featured' ? true : false
          "
          [imgURL]="item.images.length ? item.images[0].value : ''"
          [price]="item.pricing"
          [showPrice]="true"
          [itemParams]="item.params"
          [responsiveWidthVersion]="true"
        ></app-saleflow-item>
      </a>
    </div>
    <div
      *ngIf="allItems.length && layout === 'description-card'"
      class="description-card-grid"
      style="
        padding: 24px;
        display: grid;
        grid-template-columns: 1fr;
        gap: 15px;
        height: calc(100vh - 98px);
        overflow-y: scroll;
        overflow-x: hidden;
      "
      (scroll)="infinitePagination()"
    >
      <a
        class="capsize"
        [routerLink]="['../article-editor', item._id]"
        *ngFor="let item of allItems; let itemIndex = index"
        style="text-decoration: none"
      >
        <app-buyer-card
          [index]="itemIndex"
          [title]="item.name"
          [description]="item.description"
          [img]="item.images?.length ? item.images[0].value : ''"
          [leftAmount]="item.pricing"
          [cta]="false"
          [ctaActive]="item.isSelected"
          [viewsCounter]="true"
          [views]="item.visitorCounter ? item.visitorCounter.counter : 0"
        ></app-buyer-card>
      </a>
    </div> -->
    <div
      [ngStyle]="{
        width: '100%',
        display: 'flex',
        flexDirection: 'column',
        height: '80px',
        justifyContent: 'center'
      }"
      *ngIf="paginationState.status === 'loading'"
    >
      <app-dot-loader></app-dot-loader>
    </div>
  </div>
</app-navigation>
