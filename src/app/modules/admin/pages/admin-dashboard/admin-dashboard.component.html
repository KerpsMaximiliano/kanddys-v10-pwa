<div class="container">
  <header class="header">
    <div class="left">
      <button class="btn merchant-btn" [matMenuTriggerFor]="menu">
        <img [src]="_MerchantsService.merchantData.image" class="img" />
        <p class="title">{{ _MerchantsService.merchantData.name }}</p>
      </button>
      <mat-menu #menu="matMenu">
        <a mat-menu-item [routerLink]="['']">
          <mat-icon>settings</mat-icon>
          <span>Configuración</span>
        </a>
        <button mat-menu-item (click)="logout()">
          <mat-icon>exit_to_app</mat-icon>
          <span>Cerrar Sesión</span>
        </button>
      </mat-menu>
    </div>

    <div class="right">
      <a class="btn"
        [routerLink]="['../notifications-menu']"
        [queryParams]="{ 
          redirectTo: router.url
        }"
        *ngIf="ordersToConfirm.length === 0"
      >
        <img class="listIcon" [src]="environment + '/icon-i.svg'" />
      </a>

      <a class="btn"
        [routerLink]="['../notifications-menu']"
        [queryParams]="{ 
          redirectTo: router.url
        }"
        *ngIf="ordersToConfirm.length > 0"
      >
        <img class="listIcon" [src]="environment + '/bell-notification.svg'" />
      </a>
      <!-- <button class="btn blackButton">
        <p>Programas</p>
        <img class="starIcon" [src]="environment + '/star.svg'" />
      </button> -->
    </div>
  </header>

  <div class="categories">
    <swiper [config]="swiperConfig">
      <div class="category-item active">
        TODOS
      </div>
      <div class="category-item" *ngFor="let tag of tags; let i = index" [ngClass]="{ active: isTagActive(tag) }" (click)="filterTag(i)">
        {{ tag.name }}
      </div>
    </swiper>
  </div>

  <!-- <div class="contents">
    <app-options-bar
      [type]="'3'"
      [options]="options"
      (selectedIndex)="selectTag($event)"
      (selectedMenuIndex)="selectedMenuOption($event)"
    >
    </app-options-bar>
  </div> -->

  <div class="section">
    <div class="section-header">
      <h3 class="section-title">
        Ventas recientes
      </h3>

      <div class="section-description">
        <p>
          4 de los últimos 7 días
        </p>
        <img [src]="environment + '/arrow-left.svg'" alt="">
      </div>
    </div>

    <div class="section-content">
      <swiper [config]="cardSwiperConfig" >
        <mat-card class="card" *ngFor="let item of recentlySoldItems">
          <a [routerLink]="['../article-editor', item._id]">
            <div class="card-body">
              <div class="card-l-side">
                <h2 class="card-title">{{ item.name ? item.name : 'Sin nombre...' }}</h2>
                <p class="card-description"> {{ item.description }}</p>
              </div>
              <div class="card-r-side">
                <div class="featured-image" [ngStyle]="{ backgroundImage: 'url(' + item?.images[0]?.value + ')' }">
                  <div class="caption" *ngIf="item.status === 'disabled'">
                    <img [src]="environment + '/closed-eye-black.svg'" alt="">
                    Oculto al visitante
                  </div>
                </div>
              </div>
            </div>
          </a>
          <div class="card-footer">
            <div class="bottom-title">
              <h3>RD $ {{ item.pricing | number }}</h3>
            </div>
            <div class="bottom-icons">
              <div class="text-icon">
                <p>{{ item?.visitorCounter?.counter ? item?.visitorCounter?.counter : '0' }}</p>
                <img [src]="environment + '/open-eye.svg'" alt="">
              </div>
              <div class="text-icon">
                <img [src]="environment + '/dots-black.svg'" alt="">
              </div>
            </div>
          </div>
        </mat-card>
      </swiper>
    </div>
  </div>

  <div class="section">
    <div class="section-header">
      <h3 class="section-title">
        20% menos vendidos
      </h3>

      <div class="section-description">
        <p>
          4 de los últimos 7 días
        </p>
        <img [src]="environment + '/arrow-left.svg'" alt="">
      </div>
    </div>

    <div class="section-content">
      <swiper [config]="cardSwiperConfig" >
        <mat-card class="card" *ngFor="let item of lessSoldItems">
          <a [routerLink]="['../article-editor', item._id]">
            <div class="card-body">
              <div class="card-l-side">
                <h2 class="card-title">{{ item.name ? item.name : 'Sin nombre...' }}</h2>
                <p class="card-description"> {{ item.description }}</p>
              </div>
              <div class="card-r-side">
                <div class="featured-image" [ngStyle]="{ backgroundImage: 'url(' + item?.images[0]?.value + ')' }">
                  <div class="caption" *ngIf="item.status === 'disabled'">
                    <img [src]="environment + '/closed-eye-black.svg'" alt="">
                    Oculto al visitante
                  </div>
                </div>
              </div>
            </div>
          </a>
          <div class="card-footer">
            <div class="bottom-title">
              <h3>RD $ {{ item.pricing | number }}</h3>
            </div>
            <div class="bottom-icons">
              <div class="text-icon">
                <p>{{ item.visitorCounter.counter }}</p>
                <img [src]="environment + '/open-eye.svg'" alt="">
              </div>
              <div class="text-icon">
                <img [src]="environment + '/dots-black.svg'" alt="">
              </div>
            </div>
          </div>
        </mat-card>
      </swiper>
    </div>
  </div>

  <div class="section">
    <div class="section-header">
      <h3 class="section-title">
        20% más vendidos
      </h3>

      <div class="section-description">
        <p>
          4 de los últimos 7 días
        </p>
        <img [src]="environment + '/arrow-left.svg'" alt="">
      </div>
    </div>

    <div class="section-content">
      <swiper [config]="cardSwiperConfig" >
        <mat-card class="card" *ngFor="let item of mostSoldItems">
          <a [routerLink]="['../article-editor', item._id]">
            <div class="card-body">
              <div class="card-l-side">
                <h2 class="card-title">{{ item.name ? item.name : 'Sin nombre...' }}</h2>
                <p class="card-description"> {{ item.description }}</p>
              </div>
              <div class="card-r-side">
                <div class="featured-image" [ngStyle]="{ backgroundImage: 'url(' + item?.images[0]?.value + ')' }">
                  <div class="caption" *ngIf="item.status === 'disabled'">
                    <img [src]="environment + '/closed-eye-black.svg'" alt="">
                    Oculto al visitante
                  </div>
                </div>
              </div>
            </div>
          </a>
          <div class="card-footer">
            <div class="bottom-title">
              <h3>RD $ {{ item.pricing | number }}</h3>
            </div>
            <div class="bottom-icons">
              <div class="text-icon">
                <p>{{ item.visitorCounter.counter }}</p>
                <img [src]="environment + '/open-eye.svg'" alt="">
              </div>
              <div class="text-icon">
                <img [src]="environment + '/dots-black.svg'" alt="">
              </div>
            </div>
          </div>
        </mat-card>
      </swiper>
    </div>
  </div>

  <div class="uploadButton">
    <button mat-fab class="button" (click)="settings()">
      <mat-icon style="color: #82f18d">menu</mat-icon>
      <!-- <img class="icon" [src]="environment + '/upload.svg'" /> -->
    </button>
  </div>

  <div class="sticky-bar">
    <p>PREVIEW</p>
    <div>
      <p>VISIBLE EN: URL.COM</p>
      <img [src]="environment + '/upload.svg'" alt="">
    </div>
  </div>

  <!-- <div
    class="saleflows-item-grid"
    (scroll)="infinitePagination()"
    *ngIf="allItems.length && (layout === 'simple-card' || !layout)"
  >
    <a
      class="capsize"
      [routerLink]="['../article-editor', item._id]"
      *ngFor="let item of allItems; let itemIndex = index"
    >
      <app-saleflow-item
        [itemIndex]="itemIndex"
        [itemId]="item._id"
        [type]="4"
        [showViews]="true"
        [viewsCounter]="item.visitorCounter ? item.visitorCounter.counter : 0"
        [inactive]="
          item.status != 'active' && item.status != 'featured' ? true : false
        "
        [imgURL]="item.images.length ? item.images[0].value : ''"
        [price]="item.pricing"
        [showPrice]="true"
        [itemParams]="item.params"
        [responsiveWidthVersion]="true"
      ></app-saleflow-item>
    </a>
  </div>
  <div
    *ngIf="allItems.length && layout === 'description-card'"
    class="description-card-grid"
    style="
      padding: 24px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 15px;
      height: calc(100vh - 98px);
      overflow-y: scroll;
      overflow-x: hidden;
    "
    (scroll)="infinitePagination()"
  >
    <a
      class="capsize"
      [routerLink]="['../article-editor', item._id]"
      *ngFor="let item of allItems; let itemIndex = index"
      style="text-decoration: none"
    >
      <app-buyer-card
        [index]="itemIndex"
        [title]="item.name"
        [description]="item.description"
        [img]="item.images?.length ? item.images[0].value : ''"
        [leftAmount]="item.pricing"
        [cta]="false"
        [ctaActive]="item.isSelected"
        [viewsCounter]="true"
        [views]="item.visitorCounter ? item.visitorCounter.counter : 0"
      ></app-buyer-card>
    </a>
  </div> -->
  <div
    [ngStyle]="{
      width: '100%',
      display: 'flex',
      flexDirection: 'column',
      height: '80px',
      justifyContent: 'center'
    }"
    *ngIf="paginationState.status === 'loading'"
  >
    <app-dot-loader></app-dot-loader>
  </div>
</div>
