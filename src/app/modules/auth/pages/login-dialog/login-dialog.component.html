<mat-vertical-stepper
  [linear]="true"
  #stepper
  (selectionChange)="onStepChange($event)"
>
  <mat-step label="Número de teléfono" state="phone" [stepControl]="phoneStep" [editable]="!newUser">
    <form [formGroup]="phoneStep">
      <div class="wrapper">
        <ngx-intl-tel-input
          [cssClass]="'custom'"
          [enableAutoCountrySelect]="true"
          [enablePlaceholder]="true"
          [searchCountryFlag]="true"
          [selectFirstCountry]="false"
          [preferredCountries]="preferredCountries"
          [selectedCountryISO]="CountryISO"
          maxLength="13"
          minlength="10"
          [phoneValidation]="true"
          [separateDialCode]="true"
          [customPlaceholder]="'(000) 000-0000'"
          [numberFormat]="PhoneNumberFormat.International"
          formControlName="phoneNumber"
          tabindex="1"
        ></ngx-intl-tel-input>
      </div>
      <button
        mat-button
        matStepperNext
        [disabled]="phoneStep.invalid"
        (click)="data?.loginType === 'phone' && submitPhone()"
      >
        Continuar
      </button>
    </form>
  </mat-step>
  <mat-step
    [stepControl]="passwordStep"
    *ngIf="data?.loginType === 'full'"
    [editable]="false"
  >
    <form [formGroup]="passwordStep">
      <ng-template matStepLabel>Código o contraseña</ng-template>
      <mat-form-field appearance="outline">
        <mat-label>{{
          this.user ? "Código o contraseña" : "Contraseña"
        }}</mat-label>
        <input matInput type="password" formControlName="password" required />
        <mat-hint *ngIf="!user"
          >Por defecto son los últimos 4 dígitos de tu teléfono</mat-hint
        >
      </mat-form-field>
      <div>
        <button
          mat-button
          matStepperNext
          (click)="submitCodePassword()"
          [ngStyle]="{ marginTop: !user && '12px' }"
        >
          {{ this.user ? "Ingresar" : "Continuar" }}
        </button>
      </div>
    </form>
  </mat-step>
  <mat-step *ngIf="data?.loginType === 'full' && userStep === 'code'">
    <form [formGroup]="codeStep">
      <ng-template matStepLabel>{{
        userStep === "code" ? "Código de verificación" : "Contraseña"
      }}</ng-template>
      <mat-form-field appearance="outline">
        <mat-label>{{
          userStep === "code" ? "Código" : "Contraseña"
        }}</mat-label>
        <input matInput type="password" formControlName="code" required />
      </mat-form-field>
      <div>
        <button mat-button (click)="submitCodePassword()">Ingresar</button>
      </div>
    </form>
  </mat-step>

  <!-- <mat-step
    *ngIf="
      data?.loginType === 'full' &&
      ((!user?.validatedAt && userStep !== 'phone') || userStep === 'code')
    "
  >
    <form [formGroup]="passwordStep">
      <ng-template matStepLabel>Contraseña</ng-template>
      <mat-form-field appearance="outline">
        <mat-label>Contraseña</mat-label>
        <input matInput type="password" formControlName="password" required />
      </mat-form-field>
      <div>
        <button mat-button (click)="submitCodePassword()">Ingresar</button>
      </div>
    </form>
  </mat-step> -->
</mat-vertical-stepper>
