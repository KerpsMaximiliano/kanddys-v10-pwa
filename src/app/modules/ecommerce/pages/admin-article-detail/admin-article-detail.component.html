<div class="main-container">
  <nav>
    <div class="subnav">
      <a class="exit"> X </a>
    </div>
    <div class="subnav right">
      <mat-slide-toggle
        class="toggle"
        [checked]="active"
        (change)="updateItem('toggle')"
      >
      </mat-slide-toggle>
    </div>
  </nav>
  <div class="article-info">
    <img alt="" class="article-img" [src]="item?.images[0].value" />
    <p class="article-name">{{item?.name}}</p>
    <p class="article-description">{{item?.description}}</p>
  </div>
  <div class="tab-bar">
    <p 
      (click)="tabIndex = 1"
      [class]="{'active': tabIndex === 1}"
    >DATOS</p>
    <p 
      (click)="tabIndex = 2"
      [class]="{'active': tabIndex === 2}"
    >üåº VITRINA</p>
    <p 
      (click)="tabIndex = 3"
      [class]="{'active': tabIndex === 3}"
    >RESULTADOS</p>
  </div>
  <main *ngIf="tabIndex === 2">
    <div class="category">
      <h2>Precios</h2>
      <div class="info-card">
        <h3>Precio normal exhibido en MerchantID</h3>
        <p>{{item?.pricing | currency}}</p>
      </div>
      <div class="add-card">
        <p class="plus">+</p>
        <p>Adiciona ID</p>
      </div>
    </div>
    <div class="category">
      <h2>Categories</h2>
      <!--<div class="info-card">
        <h3>Precio normal exhibido en MerchantID</h3>
        <p>{{item?.pricing | currency}}</p>
      </div>-->
      <div class="add-card">
        <p class="plus">+</p>
        <p>Adiciona un Grupo</p>
      </div>
      <div class="add-card">
        <p class="plus">+</p>
        <p>Adiciona un hashtag</p>
      </div>
    </div>
    <div class="category">
      <h2>Compra</h2>
      <!--<div class="info-card">
        <h3>Precio normal exhibido en MerchantID</h3>
        <p>{{item?.pricing | currency}}</p>
      </div>-->
      <div class="add-card">
        <p class="plus">+</p>
        <p>Tiempo Aproximado de Entrega</p>
      </div>
      <div class="add-card">
        <p class="plus">+</p>
        <p>Preguntas al Comprador</p>
      </div>
    </div>
    <div class="category">
      <h2>Categories</h2>
      <!--<div class="info-card">
        <h3>Precio normal exhibido en MerchantID</h3>
        <p>{{item?.pricing | currency}}</p>
      </div>-->
      <div class="add-card">
        <p class="plus">+</p>
        <p>Adiciona un Grupo</p>
      </div>
      <div class="add-card">
        <p class="plus">+</p>
        <p>Costo de la Venta</p>
      </div>
    </div>
  </main>
  <!--<div *ngIf="tabIndex === 1" class="container">
    <div class="info-card">
      <p class="card-title">Precio normal exhibido en MerchantID</p>
      <p class="display-text">{{item?.pricing | currency}}</p>
    </div>
    <div *ngIf="isHashtagExist && hashtagSelected?.keyword" class="info-card"(click)="openDialog('hashtag')">
      <p class="card-title">Hashtag</p>
      <p class="display-text">{{itemHashtagInput?.value}}</p>
    </div>
    <div *ngIf="deliveryTimeStart || deliveryTimeEnd" class="info-card"(click)="openDialog('deliverytime')">
      <p class="card-title">Tiempo de Entrega</p>
      <p *ngIf="deliveryTimeStart && deliveryTimeEnd" class="display-text" >
        Desde {{deliveryTimeStart}} horas hasta {{deliveryTimeEnd}} horas
      </p>
      <p *ngIf="deliveryTimeStart && !deliveryTimeEnd" class="display-text">
        {{deliveryTimeStart}} horas
      </p>
      <p *ngIf="deliveryTimeEnd && !deliveryTimeStart" class="display-text">
        {{deliveryTimeEnd}} horas
      </p>
    </div>
    <div *ngIf="numberOfRequiredQuestions > 0 || numberOfOptionalQuestions > 0" class="info-card" (click)="gotoWebform()">
      <p class="card-title">Formulario de preguntas</p>
      <p *ngIf="numberOfRequiredQuestions > 0 && numberOfOptionalQuestions > 0" class="display-text">
        {{
          numberOfRequiredQuestions + (numberOfRequiredQuestions > 1 ? ' preguntas requeridas y ' : ' pregunta requerida y ') +  
          numberOfOptionalQuestions + (numberOfOptionalQuestions > 1 ? ' preguntas opcionales y ' : ' pregunta opcional')
        }}
      </p>
      <p *ngIf="numberOfRequiredQuestions > 0 && numberOfOptionalQuestions === 0" class="display-text">
        {{
          numberOfRequiredQuestions + (numberOfRequiredQuestions > 1 ? ' preguntas requeridas' : ' pregunta requerida')
        }}
      </p>
      <p *ngIf="numberOfRequiredQuestions === 0 && numberOfOptionalQuestions > 0" class="display-text">
        {{
          numberOfOptionalQuestions + (numberOfOptionalQuestions > 1 ? ' preguntas opcionales' : ' pregunta opcional')
        }}
      </p>
    </div>
    <div class="container" *ngFor="let expenditure of expenditures">
        <div class="info-card" (click)="openDialog('expenditure-update', expenditure._id)">
          <p class="card-title">Costo: {{expenditure.name}}</p>
          <p class="display-text">{{expenditure.amount | currency}}</p>
        </div>
    </div>
  </div>
  <div *ngIf="tabIndex  === 2" class="container">
    <p class="data-title">
      üåº VITRINA
    </p>
    <div class="input-card" *ngIf="!hashtagSelected">
      <p class="input-text"># ¬øTe convendr√≠a publicar un hashtag en tus redes sociales para que cuando lo escriban en el buscador lleguen directo a comprarlo?</p>
      <button class="input-button" (click)="openDialog('hashtag')">
        <img
          src="../../../../../assets/icons/add-button.svg"
          alt="add item"
        />
      </button>
    </div>
    <div class="input-card">
      <p class="input-text">üñáÔ∏è ¬øLo quieres incluir en una sub-vitrina para que se exhibirlo junto a otros de tus art√≠culos?</p>
      <button class="input-button">
        <img
          src="../../../../../assets/icons/add-button.svg"
          alt="add item"
        />
      </button>
    </div>
    <div class="input-card">
      <p class="input-text">üè∑Ô∏èÔ∏è ¬øLo quieres incluir en la Vitrina Global dedicada a TipodeCompradorID junto a otros art√≠culos relacionados de otras tiendas?</p>
      <button class="input-button">
        <img
          src="../../../../../assets/icons/add-button.svg"
          alt="add item"
        />
      </button>
    </div>
    <div class="input-card">
      <p class="input-text">üì¢ Si lo incluyes en el Mercado de Referencias, los Embajadores lo promocionar√°n y lo vender√°n (mira mas).</p>
      <button class="input-button">
        <img
          src="../../../../../assets/icons/add-button.svg"
          alt="add item"
        />
      </button>
    </div>
  </div>
  <div *ngIf="" class="container">
    <p class="data-title">
      OPCIONAL- DATOS QUE LOS COMPRADORES CONSIDERAN IMPORTANTES
    </p>
    <div class="input-card">
      <p class="input-text">‚è∞ Tiempo aproximado de entrega</p>
      <button class="input-button" (click)="openDialog('deliverytime')">
        <img
          src="../../../../../assets/icons/add-button.svg"
          alt="add item"
        />
      </button>
    </div>
  </div>
  <div class="container">
    <p class="data-title">
      FUNCIONALIDADES OPCIONALES
    </p>
    <div 
      *ngIf="numberOfRequiredQuestions === 0 && numberOfOptionalQuestions === 0" 
      class="input-card"
    >
      <p class="input-text">¬øTe tiene que responder algo el comprador antes de pagarte por este art√≠culo?</p>
      <button class="input-button" (click)="gotoWebform()">
        <img
          src="../../../../../assets/icons/add-button.svg"
          alt="add item"
        />
      </button>
    </div>
    <div class="input-card last">
      <p class="input-text">¬øQuieres incluir el costo de vender este art√≠culo en tu reporte de los beneficios?</p>
      <button class="input-button" (click)="openDialog('cost')">
        <img
          src="../../../../../assets/icons/add-button.svg"
          alt="add item"
        />
      </button>
    </div>
  </div>-->
  <div *ngIf="tabIndex === 3" class="container dropdown">
    <div class="metric">
      <h4>Cantidad de veces Vendido</h4>
      <p>{{ totalSells }} veces, ${{ totalIncome }}</p>
    </div>
    <div class="metric">
      <h4>Cantidad de compradores diferentes</h4>
      <p>{{buyers}}</p>
    </div>
    <div class="metric">
      <h4>Comprador que mas lo ha comprado</h4>
      <p>CompradorID</p>
    </div>
    <div class="metric">
      <h4>Posicion segun las ventas</h4>
      <p>
        {{
          salesPositionInStore > 0
            ? salesPositionInStore + " de " + totalItemsOfMerchant
            : "No se ha vendido todav√≠a"
        }}
      </p>
    </div>
  </div>
  <div
    class="bottom-bar"
    [ngStyle]="{'background-color': active ? 'var(--El-verdecito, #87CD9B)' : 'var(--MoKito, #936105)'}"
  >
    <p class="center" *ngIf="tabIndex !== 3">Salvar Cambios</p>
    <ng-container *ngIf="tabIndex === 3">
      <p 
      class="preview"
      [ngStyle]="{'color': active ? '#181D17' : '#FFF'}"
      (click)="goToItemDetail()"
    >
      Preview
    </p>
    <p 
      class="share"
      [ngStyle]="{'color': active ? '#181D17' : '#FFF'}"
      (click)="share()"
    >
      {{active ? 'Comparte con Compradores' : 'Oculto en todas las Vitrinas'}}
    </p>
    </ng-container>
  </div>
</div>
