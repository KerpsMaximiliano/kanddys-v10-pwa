<div class="component">
  <header>
    <div>
      <a (click)="goBack()"><i class="fas fa-chevron-left"></i></a>
      <h5>
        {{ mode === "normal" ? "Dirección de entrega" : "Modo de edición" }}
      </h5>
    </div>
    <button
      *ngIf="
        mode === 'normal' &&
        saleflow?.module?.delivery?.deliveryLocation &&
        user
      "
      class="dot-trio"
      (click)="onOpenDialog()"
    >
      <div class="dot"> </div>
      <div class="dot"> </div>
      <div class="dot"> </div>
    </button>
  </header>
  <main>
    <ng-container *ngIf="mode === 'auth'">
      <h3 class="title">Seleccione entre:</h3>

      <app-answer-selector
        [options]="authOptions"
        [activeOption]="selectedAuthIndex"
        [indicator]="true"
        [containerStyles]="{
          margin: '0px'
        }"
        (onSelector)="selectedAuthIndex = $event"
      ></app-answer-selector>
    </ng-container>
    <ng-container *ngIf="mode !== 'auth' && mode !== 'add' && !editingId">
      <h3 class="title">Seleccione entre:</h3>
      <div>
        <app-answer-selector
          [options]="addressesOptions"
          [activeOption]="selectedDeliveryIndex"
          [indicator]="true"
          (onSelector)="selectedDeliveryIndex = $event"
          [containerStyles]="{
            margin: '0px'
          }"
        ></app-answer-selector>
      </div>
      <ng-container *ngIf="newAddressOption?.length">
        <div>
          <app-answer-selector
            [options]="newAddressOption"
            [indicator]="true"
            (onSelector)="mode = 'add'"
            [containerStyles]="{
              margin: '0px'
            }"
          ></app-answer-selector>
        </div>
      </ng-container>
    </ng-container>
    <ng-container *ngIf="mode === 'add' || editingId">
      <form [formGroup]="addressForm">
        <div class="form-group">
          <label class="input-label" for="nickName"
            >Nombre de la direccion</label
          >
          <input
            type="text"
            class="input-text"
            id="nickName"
            name="nickName"
            placeholder="Mi casa.."
            formControlName="nickName"
            required
          />
        </div>
        <div class="form-group">
          <label class="input-label" for="nickName">Calle</label>
          <input
            type="text"
            class="input-text"
            id="street"
            name="street"
            formControlName="street"
            required
          />
        </div>
        <div class="form-group">
          <label class="input-label" for="nickName"
            >Número de casa/apartamento (opcional)</label
          >
          <input
            type="number"
            min="0"
            inputmode="numeric"
            pattern="[0-9]*"
            class="input-text"
            id="houseNumber"
            name="houseNumber"
            formControlName="houseNumber"
          />
        </div>
        <div class="form-group">
          <label class="input-label" for="nickName"
            >Punto de referencia (opcional)</label
          >
          <input
            type="text"
            class="input-text"
            id="referencePoint"
            name="referencePoint"
            formControlName="referencePoint"
          />
        </div>
        <div class="form-group">
          <label class="input-label" for="nickName">Nota (opcional)</label>
          <input
            type="text"
            class="input-text"
            id="note"
            name="note"
            formControlName="note"
          />
        </div>
      </form>
    </ng-container>
  </main>
</div>
<app-sticky-button
  *ngIf="mode === 'add' || editingId"
  [mode]="addressForm?.valid && !disableButton ? 'fixed' : 'disabled-fixed'"
  text="GUARDA Y CONTINUA AL CHECKOUT"
  bgColor="#2874AD"
  size="small"
  (click)="!disableButton && formSubmit()"
></app-sticky-button>
<app-sticky-button
  *ngIf="mode === 'normal' && selectedDeliveryIndex != null"
  mode="fixed"
  text="CONTINUA AL CHECKOUT"
  bgColor="#2874AD"
  size="small"
  (click)="selectAddress()"
></app-sticky-button>
<app-sticky-button
  *ngIf="mode === 'auth' && selectedAuthIndex != null"
  mode="fixed"
  text="CONFIRMAR ELECCIÓN"
  bgColor="#2874AD"
  size="small"
  (click)="authSelect(selectedAuthIndex)"
></app-sticky-button>
<app-sticky-button
  *ngIf="(mode === 'edit' && !editingId) || mode === 'delete'"
  mode="fixed"
  [backButton]="true"
  bgColor="#2874AD"
  size="small"
  (click)="goBack()"
></app-sticky-button>
