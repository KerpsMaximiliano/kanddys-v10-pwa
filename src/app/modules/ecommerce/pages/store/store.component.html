<div class="store-page" (scroll)="infinitePagination()">
  <div class="component">
    <header>
      <div class="header" *ngIf="selectedTags.length === 0">
        <button class="left">
          <img
            [src]="env + '/arrow-double-up-black.svg'"
            alt="arrows"
            class="arrows"
          />
        </button>
        <div class="title">
          {{
            header.saleflow?.merchant?.name.length < 26
              ? header.saleflow?.merchant?.name
              : header.saleflow?.merchant?.name.slice(0, 25) + ".." || "Tienda"
          }}
        </div>

        <button class="user-area" (click)="openUserManagementDialog()">
          <span *ngIf="header.user">{{
            (header.user.name || header.user.phone || header.user.email)
              .length > 10
              ? (
                  header.user.name ||
                  header.user.phone ||
                  header.user.email
                ).slice(0, 10) + ".."
              : header.user.name || header.user.phone || header.user.email
          }}</span>
          <span *ngIf="!header.user">CompradorID</span>
          <img class="icon" [src]="env + '/user-white.svg'" />
        </button>
      </div>
    </header>
    <main>
      <div class="top-input-area">
        <!-- ********************************************** SEARCHBAR ************************************-->
        <!-- <input
          class="text"
          placeholder="Busca por tag o nombre de articulo"
          class="input-top"
          [ngStyle]="{
            marginBottom: tags.length !== 0 ? '28px' : '0px'
          }"
          *ngIf="showSearchbar"
          [formControl]="searchBar"
        /> -->
        <!-- ******************************************** ENDSEARCHBAR ************************************-->

        <!-- ******************************************* TAG SWIPER ***************************************-->
        <div style="width: 100%; padding: 0px 0px 0px 21px">
          <swiper [config]="swiperConfigTag" #tagsSwiper>
            <div
              class="tags-area swiper-slide"
              [ngStyle]="{
                maxWidth: '115px'
              }"
              *ngFor="let tag of unselectedTags"
            >
              <ng-container *ngFor="let tag2 of tags; let tagIndex = index">
                <ng-container *ngIf="tag2._id === tag._id">
                  <div
                    (click)="selectTag(tag, tagIndex)"
                    class="tag-item"
                    [ngStyle]="{
                      width: '115px',
                      height: '120px',
                      'background-image':
                        tag.images?.length > 0
                          ? 'linear-gradient(transparent 70%, #fff),url(' +
                            tag.images[0] +
                            ')'
                          : 'linear-gradient(transparent 70%, #fff),url(' +
                            env +
                            '/noimage.png' +
                            ')'
                    }"
                  ></div>
                  <span class="tag-name">{{ tag.name }}</span>
                </ng-container>
              </ng-container>
            </div>
          </swiper>
        </div>
        <!-- **************************************** END TAG SWIPER ***************************************-->
      </div>

      <!--REGULAR MERCHANT-->
      <div class="content">
        <!--SHOWS ITEMS HIGHLIGHTED-->
        <div
          *ngIf="
            highlightedItems.length > 0 &&
            searchBar.value === '' &&
            selectedTags.length === 0
          "
          [ngStyle]="{
            paddingLeft: '25px'
          }"
        >
          <div class="header-wrapper">
            <h2 class="items-header">Destacados</h2>
          </div>

          <div></div>
          <swiper [config]="swiperConfigHighlightedItems">
            <div
              *ngFor="let item of highlightedItems; let i = index"
              [ngStyle]="{
                width: 'auto',
                paddingBottom: '10px',
                paddingRight: '13px'
              }"
            >
              <app-saleflow-item
                [itemIndex]="i"
                [itemId]="item._id"
                [type]="4"
                [imgURL]="item.images ? item.images[0] : ''"
                [price]="item.pricing"
                [itemParams]="item.params"
                [showPrice]="true"
                (itemClicked)="onItemClick(item._id)"
                [dynamicStyles]="{
                  itemContainer: {
                    minWidth: '242px',
                    height: '315px',
                    margin: '0px'
                  },
                  simpleCard: {
                    height: '100%'
                  },
                  itemImg: {
                    height: '82.8571%'
                  },
                  infoArea: {
                    height: '17.1429%'
                  }
                }"
              ></app-saleflow-item>
              <div class="blank-space"></div>
            </div>
          </swiper>
        </div>

        <div class="title-and-options">
          <h2 class="title">
            {{
              searchBar.value !== ""
                ? "Resultados"
                : searchBar.value === "" && selectedTags.length === 0
                ? "Todos los productos"
                : "Resultados"
            }}
          </h2>
        </div>

        <p class="subtitle" *ngIf="items.length === 0">
          {{
            searchBar.value === "" && items.length === 0
              ? "No hay items"
              : searchBar.value !== "" && items.length === 0
              ? "No se encontr√≥ nada"
              : null
          }}
        </p>

        <div class="saleflows-item-grid">
          <div
            class="capsize"
            *ngFor="let item of items; let itemIndex = index"
          >
            <app-saleflow-item
              [itemIndex]="itemIndex"
              [itemId]="item._id"
              [type]="4"
              [inactive]="
                item.status != 'active' && item.status != 'featured'
                  ? true
                  : false
              "
              [imgURL]="item.images?.length ? item.images[0] : ''"
              [price]="item.pricing"
              [showPrice]="true"
              [itemParams]="item.params"
              (itemClicked)="onItemClick(item._id)"
              [responsiveWidthVersion]="true"
            ></app-saleflow-item>
          </div>
        </div>
      </div>

      <ul class="footer-links">
        <li
          *ngFor="let term of terms"
          class="link"
          (click)="redirectToTermsOfUse(term)"
        >
          {{ term.text }}
        </li>
      </ul>

      <div class="blank-footer"></div>

      <app-merchant-contact></app-merchant-contact>
    </main>
  </div>
</div>
