<ng-template #merchantInfo>
  <div
    class="icon"
    [style.background]="
      _DomSanitizer.bypassSecurityTrustStyle(
        'url(' +
          headerService.saleflow?.merchant?.image +
          ') no-repeat center center / cover #e9e371'
      )
    "
  ></div>
  <p class="title">
    {{
      headerService.saleflow?.merchant?.name.length < 26
        ? headerService.saleflow?.merchant?.name
        : (headerService.saleflow?.merchant?.name.slice(0, 26) + ".." ||
            "Tienda" | titlecase)
    }}
  </p>
</ng-template>

<div class="store-page" (scroll)="infinitePagination()">
  <div class="component">
    <nav
      class="header"
      [ngStyle]="{
        backgroundColor:
          headerService.user?._id === headerService.saleflow?.merchant.owner._id
            ? '#2874AD'
            : '#272727'
      }"
    >
      <a
        style="cursor: pointer"
        class="merchant-info"
        [routerLink]="[
          '/ecommerce',
          headerService.saleflow?.merchant.slug,
          'contact-landing',
          headerService.saleflow?.merchant.owner._id
        ]"
        *ngIf="
          headerService.user?._id === headerService.saleflow?.merchant.owner._id
        "
      >
        <ng-template [ngTemplateOutlet]="merchantInfo"></ng-template>
      </a>
      <div
        class="merchant-info"
        *ngIf="
          headerService.user?._id !== headerService.saleflow?.merchant.owner._id
        "
      >
        <ng-template [ngTemplateOutlet]="merchantInfo"></ng-template>
      </div>

      <p class="title" style="margin-left: 8px">Store</p>
    </nav>
    <main>
      <div class="top-input-area" *ngIf="hasCollections">
        <app-options-bar
          [options]="[{ title: 'articulos' }, { title: 'colecciones' }]"
          type="3"
          (selectedIndex)="onTabClick($event)"
        >
        </app-options-bar>
      </div>
      <br *ngIf="!hasCollections">

      <!-- ******************************************* TAG SWIPER ***************************************-->
      <div style="width: 100%; padding: 0px 0px 0px 21px">
        <swiper [config]="swiperConfigTag" #tagsSwiper>
          <a
            *ngFor="let tag of tags"
            [ngStyle]="{
              maxWidth: '115px',
              textDecoration: 'none'
            }"
            [routerLink]="['../categories', tag._id]"
          >
            <app-gradient-card [tag]="tag"></app-gradient-card>
          </a>
        </swiper>
      </div>
      <!-- **************************************** END TAG SWIPER ***************************************-->

      <!--REGULAR MERCHANT-->
      <div class="content">
        <div
          class="saleflows-item-grid"
          *ngIf="
            !headerService.saleflow.layout ||
            headerService.saleflow.layout === 'simple-card'
          "
        >
          <div
            class="capsize"
            *ngFor="let item of items; let itemIndex = index"
          >
            <a
              [routerLink]="['../article-detail/item', item._id]"
              [queryParams]="{ mode: 'saleflow' }"
            >
              <app-saleflow-item
                [itemIndex]="itemIndex"
                [itemId]="item._id"
                [type]="4"
                [inactive]="
                  item.status != 'active' && item.status != 'featured'
                    ? true
                    : false
                "
                [imgURL]="item.images?.length ? item.images[0].value : ''"
                [price]="item.pricing"
                [showPrice]="true"
                [dynamicStyles]="{
                  itemContainer: {
                    width: '100%',
                    height: '315px',
                    margin: '0px'
                  },
                  simpleCard: {
                    height: '100%'
                  },
                  itemImg: {
                    height: '82.8571%'
                  },
                  video: {
                    height: '82.8571%'
                  },
                  infoArea: {
                    height: '17.1429%'
                  }
                }"
              ></app-saleflow-item>
            </a>
          </div>
        </div>
        <div
          class="description-view"
          *ngIf="headerService.saleflow.layout === 'description-card'"
        >
          <a
            *ngFor="let item of items; let itemIndex = index"
            [routerLink]="['../article-detail/item', item._id]"
            [queryParams]="{ mode: 'saleflow' }"
          >
            <app-buyer-card
              [title]="item.name"
              [description]="item.description"
              [img]="item.images?.length ? item.images[0].value : ''"
              [leftAmount]="item.pricing"
            ></app-buyer-card>
          </a>
        </div>

        <div
          [ngStyle]="{
            width: '100%',
            display: 'flex',
            flexDirection: 'column',
            height: '80px',
            justifyContent: 'center'
          }"
          *ngIf="paginationState.status === 'loading'"
        >
          <app-dot-loader></app-dot-loader>
        </div>
      </div>

      <ul class="footer-links">
        <li
          *ngFor="let term of terms"
          class="link"
          (click)="redirectToTermsOfUse(term)"
        >
          {{ term.text }}
        </li>
      </ul>
    </main>
  </div>
</div>
